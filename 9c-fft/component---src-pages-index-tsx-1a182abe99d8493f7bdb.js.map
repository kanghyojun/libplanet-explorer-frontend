{"version":3,"sources":["webpack:///./src/pages/index.tsx","webpack:///./src/misc/useSearchParams.ts","webpack:///./src/misc/useQueryString.ts","webpack:///./src/generated/graphql.tsx"],"names":["BlockList","_ref3","blocks","columns","key","name","fieldName","iconName","isIconOnly","minWidth","maxWidth","isRowHeader","isResizable","isSorted","isSortedDescending","data","isPadded","onRender","block","react_default","a","createElement","Link","href","hash","Fragment","transactions","length","DetailsList","items","selectionMode","SelectionMode","none","getKey","setKey","layoutMode","DetailsListLayoutMode","justified","isHeaderVisible","onItemInvoked","navigate","IndexPage","_ref","location","_useSearchParams","_useQueryString","useQueryString","queryString","setQueryString","querystring","parse","searchParams","stringify","useSearchParams","setSearchParams","_searchParams$offset","offset","setOffset","newSearchParams","Object","assign","olderHandler","newerHandler","graphql","variables","limit","_ref2","loading","error","timestamps","map","Date","timestamp","interval","i","difficulties","difficulty","reduce","d","sum","DefaultButton","onClick","disabled","className","css","_templateObject","pages_BlockList","useMemo","search","substr","useCallback","path","pathname","withPrefix","BlockCommonFragmentDoc","gql","TransactionCommonFragmentDoc","_templateObject2","BlockListDocument","_templateObject3","BlockListComponent","props","react__WEBPACK_IMPORTED_MODULE_2__","_apollo_react_components__WEBPACK_IMPORTED_MODULE_3__","query","BlockByHashDocument","_templateObject4","BlockByHashComponent","TransactionByIdDocument","_templateObject5","TransactionByIdComponent"],"mappings":"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","file":"component---src-pages-index-tsx-1a182abe99d8493f7bdb.js","sourcesContent":["import React from 'react';\nimport { css } from 'emotion';\nimport { navigate } from 'gatsby';\nimport { DefaultButton, Link } from 'office-ui-fabric-react';\nimport {\n  DetailsList,\n  DetailsListLayoutMode,\n  SelectionMode,\n  IColumn,\n} from 'office-ui-fabric-react/lib/DetailsList';\nimport { Block, BlockListComponent } from '../generated/graphql';\nimport useSearchParams from '../misc/useSearchParams';\n\ninterface IndexPageProps {\n  location: Location;\n}\n\nconst IndexPage: React.FC<IndexPageProps> = ({ location }) => {\n  const limit = 20;\n  const [searchParams, setSearchParams] = useSearchParams(location);\n  const { offset = 0 } = searchParams;\n  const setOffset = (offset: number) => {\n    if (offset < 1) {\n      const newSearchParams = { ...searchParams };\n      delete newSearchParams.offset;\n      setSearchParams(newSearchParams);\n    } else {\n      setSearchParams({ ...searchParams, offset });\n    }\n  };\n  const olderHandler = () => {\n    setOffset(+offset + limit);\n  };\n  const newerHandler = () => {\n    setOffset(+offset - limit);\n  };\n\n  return (\n    <>\n      <BlockListComponent variables={{ offset, limit }}>\n        {({ data, loading, error }) => {\n          if (error) return <p>error!</p>;\n\n          const timestamps: Date[] | null = data && data.blocks\n            ? data.blocks.map(block => new Date(block!.timestamp))\n            : null;\n\n          let interval : number | null = timestamps ? 0 : null;\n          if (interval != null && timestamps) {\n            for (let i = 0; i < timestamps.length - 1; i++) {\n              interval += +timestamps[i] - +timestamps[i + 1];\n            }\n            interval /= (timestamps.length - 1) * 1000;\n          }\n\n          const difficulties: number[] | null = data && data.blocks\n            ? data.blocks.map(block => block!.difficulty)\n            : null;\n          let difficulty = 0;\n          if (difficulty != null && difficulties) {\n            difficulty = difficulties.reduce((d, sum) => d + sum, 0)\n              / difficulties.length;\n          }\n          return (\n            <>\n              <p key=\"interval\">Recent {limit} blocks' interval: {interval} sec</p>\n              <p key=\"difficulty\">Recent {limit} blocks' difficulty: {difficulty}</p>\n              <DefaultButton\n                onClick={newerHandler}\n                disabled={loading || offset < 1}\n                className={css`\n                  margin-right: 5px;\n                `}>\n                &larr; Newer\n              </DefaultButton>\n              <DefaultButton disabled={loading} onClick={olderHandler}>\n                Older &rarr;\n              </DefaultButton>\n              {loading ? (\n                <p>Loading&hellip;</p>\n              ) : (\n                <BlockList\n                  blocks={loading ? [] : (data!.blocks as NonNullable<Block[]>)}\n                />\n              )}\n            </>\n          );\n        }}\n      </BlockListComponent>\n    </>\n  );\n};\n\ninterface BlockListProps {\n  blocks: Pick<Block, 'hash' | 'index'>[];\n}\n\nconst BlockList: React.FC<BlockListProps> = ({ blocks }) => {\n  const columns: IColumn[] = [\n    {\n      key: 'columnIndex',\n      name: 'Index',\n      fieldName: 'index',\n      iconName: 'NumberSymbol',\n      isIconOnly: true,\n      minWidth: 5,\n      maxWidth: 40,\n      isRowHeader: true,\n      isResizable: true,\n      isSorted: false,\n      isSortedDescending: true,\n      data: 'number',\n      isPadded: true,\n    },\n    {\n      key: 'columnHash',\n      name: 'Hash',\n      fieldName: 'hash',\n      minWidth: 350,\n      maxWidth: 450,\n      isRowHeader: true,\n      isResizable: true,\n      isSorted: false,\n      isSortedDescending: false,\n      data: 'string',\n      isPadded: true,\n      onRender: block => (\n        <Link href={`./block/?${block.hash}`}>{block.hash}</Link>\n      ),\n    },\n    {\n      key: 'columnTimestamp',\n      name: 'Timestamp',\n      fieldName: 'timestamp',\n      minWidth: 100,\n      maxWidth: 200,\n      isRowHeader: true,\n      isResizable: true,\n      isSorted: false,\n      isSortedDescending: true,\n      data: 'string',\n      isPadded: true,\n    },\n    {\n      key: 'columnTxNumber',\n      name: 'Tx #',\n      fieldName: null,\n      minWidth: 5,\n      maxWidth: 20,\n      isRowHeader: true,\n      isResizable: true,\n      isSorted: false,\n      isSortedDescending: false,\n      data: 'number',\n      isPadded: true,\n      onRender: block => (\n        <>{block.transactions.length}</>\n      ),\n    },\n  ];\n  return (\n    <DetailsList\n      items={blocks}\n      columns={columns}\n      selectionMode={SelectionMode.none}\n      getKey={block => block.hash}\n      setKey=\"set\"\n      layoutMode={DetailsListLayoutMode.justified}\n      isHeaderVisible={true}\n      onItemInvoked={block => navigate(`/block/?${block.hash}`)}\n\n    />\n  );\n};\n\nexport default IndexPage;\n","import querystring from 'querystring';\nimport useQueryString from './useQueryString';\n\nexport default function useSearchParams(location: Location) {\n  const [queryString, setQueryString] = useQueryString(location);\n  const searchParams = querystring.parse(queryString);\n  const setSearchParams = (searchParams: any) =>\n    setQueryString(querystring.stringify(searchParams));\n  return [searchParams, setSearchParams] as const;\n}\n","import { useCallback, useMemo } from 'react';\nimport { navigate, withPrefix } from 'gatsby';\n\nexport default function useQueryString(location: Location) {\n  const queryString = useMemo(() => location.search.substr(1), [location]);\n  const setQueryString = useCallback((queryString: string) => {\n    const path = location.pathname.substr(withPrefix('/').length - 1);\n    navigate(path + (queryString ? `?${queryString}` : ''));\n  }, [location, navigate]);\n  return [queryString, setQueryString] as const;\n}\n","import gql from 'graphql-tag';\nimport * as React from 'react';\nimport * as ApolloReactCommon from '@apollo/react-common';\nimport * as ApolloReactComponents from '@apollo/react-components';\nimport * as ApolloReactHoc from '@apollo/react-hoc';\nexport type Maybe<T> = T | null;\nexport type Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\n/** All built-in and custom scalars, mapped to their actual values */\nexport type Scalars = {\n  ID: string,\n  String: string,\n  Boolean: boolean,\n  Int: number,\n  Float: number,\n  Address: any,\n  ByteString: any,\n  DateTimeOffset: any,\n  Date: any,\n  DateTime: any,\n  Decimal: any,\n  Milliseconds: any,\n  Seconds: any,\n};\n\nexport type Action = {\n  __typename?: 'Action',\n  arguments: Array<ActionArgumentType>,\n};\n\nexport type ActionArgumentType = {\n  __typename?: 'ActionArgumentType',\n  key: Scalars['String'],\n  value: Scalars['String'],\n};\n\n\nexport type Block = {\n  __typename?: 'Block',\n  difficulty: Scalars['Int'],\n  hash: Scalars['ID'],\n  index: Scalars['Int'],\n  miner: Scalars['Address'],\n  nonce: Scalars['ByteString'],\n  previousBlock?: Maybe<Block>,\n  timestamp: Scalars['DateTimeOffset'],\n  transactions: Array<Transaction>,\n};\n\nexport type BlockQuery = {\n  __typename?: 'BlockQuery',\n  block?: Maybe<Block>,\n  blocks?: Maybe<Array<Maybe<Block>>>,\n  transaction?: Maybe<Transaction>,\n};\n\n\nexport type BlockQueryBlockArgs = {\n  hash?: Maybe<Scalars['ID']>\n};\n\n\nexport type BlockQueryBlocksArgs = {\n  desc?: Maybe<Scalars['Boolean']>,\n  offset?: Maybe<Scalars['Int']>,\n  limit?: Maybe<Scalars['Int']>,\n  empty?: Maybe<Scalars['Boolean']>\n};\n\n\nexport type BlockQueryTransactionArgs = {\n  id?: Maybe<Scalars['ID']>\n};\n\n\n\n\n\n\n\n\nexport type Transaction = {\n  __typename?: 'Transaction',\n  actions: Array<Action>,\n  id: Scalars['ID'],\n  nonce: Scalars['Int'],\n  publicKey: Scalars['ByteString'],\n  signature: Scalars['ByteString'],\n  signer: Scalars['Address'],\n  timestamp: Scalars['DateTimeOffset'],\n  updatedAddresses: Array<Scalars['Address']>,\n};\nexport type BlockCommonFragment = ({ __typename?: 'Block' } & Pick<Block, 'hash' | 'index' | 'difficulty' | 'timestamp'>);\n\nexport type TransactionCommonFragment = ({ __typename?: 'Transaction' } & Pick<Transaction, 'id' | 'nonce' | 'publicKey' | 'signature' | 'signer' | 'timestamp' | 'updatedAddresses'>);\n\nexport type BlockListQueryVariables = {\n  offset: Scalars['Int'],\n  limit: Scalars['Int']\n};\n\n\nexport type BlockListQuery = ({ __typename?: 'BlockQuery' } & { blocks: Maybe<Array<Maybe<({ __typename?: 'Block' } & { transactions: Array<({ __typename?: 'Transaction' } & Pick<Transaction, 'id'>)> } & BlockCommonFragment)>>> });\n\nexport type BlockByHashQueryVariables = {\n  hash?: Maybe<Scalars['ID']>\n};\n\n\nexport type BlockByHashQuery = ({ __typename?: 'BlockQuery' } & { block: Maybe<({ __typename?: 'Block' } & Pick<Block, 'miner' | 'nonce'> & { previousBlock: Maybe<({ __typename?: 'Block' } & Pick<Block, 'hash'>)>, transactions: Array<({ __typename?: 'Transaction' } & TransactionCommonFragment)> } & BlockCommonFragment)> });\n\nexport type TransactionByIdQueryVariables = {\n  id?: Maybe<Scalars['ID']>\n};\n\n\nexport type TransactionByIdQuery = ({ __typename?: 'BlockQuery' } & { transaction: Maybe<({ __typename?: 'Transaction' } & TransactionCommonFragment)> });\nexport const BlockCommonFragmentDoc = gql`\n    fragment BlockCommon on Block {\n  hash\n  index\n  difficulty\n  timestamp\n}\n    `;\nexport const TransactionCommonFragmentDoc = gql`\n    fragment TransactionCommon on Transaction {\n  id\n  nonce\n  publicKey\n  signature\n  signer\n  timestamp\n  updatedAddresses\n}\n    `;\nexport const BlockListDocument = gql`\n    query BlockList($offset: Int!, $limit: Int!) {\n  blocks(desc: true, offset: $offset, limit: $limit) {\n    ...BlockCommon\n    transactions {\n      id\n    }\n  }\n}\n    ${BlockCommonFragmentDoc}`;\nexport type BlockListComponentProps = Omit<ApolloReactComponents.QueryComponentOptions<BlockListQuery, BlockListQueryVariables>, 'query'> & ({ variables: BlockListQueryVariables; skip?: boolean; } | { skip: boolean; });\n\n    export const BlockListComponent = (props: BlockListComponentProps) => (\n      <ApolloReactComponents.Query<BlockListQuery, BlockListQueryVariables> query={BlockListDocument} {...props} />\n    );\n    \nexport type BlockListProps<TChildProps = {}> = ApolloReactHoc.DataProps<BlockListQuery, BlockListQueryVariables> & TChildProps;\nexport function withBlockList<TProps, TChildProps = {}>(operationOptions?: ApolloReactHoc.OperationOption<\n  TProps,\n  BlockListQuery,\n  BlockListQueryVariables,\n  BlockListProps<TChildProps>>) {\n    return ApolloReactHoc.withQuery<TProps, BlockListQuery, BlockListQueryVariables, BlockListProps<TChildProps>>(BlockListDocument, {\n      alias: 'withBlockList',\n      ...operationOptions\n    });\n};\nexport type BlockListQueryResult = ApolloReactCommon.QueryResult<BlockListQuery, BlockListQueryVariables>;\nexport const BlockByHashDocument = gql`\n    query BlockByHash($hash: ID) {\n  block(hash: $hash) {\n    ...BlockCommon\n    miner\n    nonce\n    previousBlock {\n      hash\n    }\n    transactions {\n      ...TransactionCommon\n    }\n  }\n}\n    ${BlockCommonFragmentDoc}\n${TransactionCommonFragmentDoc}`;\nexport type BlockByHashComponentProps = Omit<ApolloReactComponents.QueryComponentOptions<BlockByHashQuery, BlockByHashQueryVariables>, 'query'>;\n\n    export const BlockByHashComponent = (props: BlockByHashComponentProps) => (\n      <ApolloReactComponents.Query<BlockByHashQuery, BlockByHashQueryVariables> query={BlockByHashDocument} {...props} />\n    );\n    \nexport type BlockByHashProps<TChildProps = {}> = ApolloReactHoc.DataProps<BlockByHashQuery, BlockByHashQueryVariables> & TChildProps;\nexport function withBlockByHash<TProps, TChildProps = {}>(operationOptions?: ApolloReactHoc.OperationOption<\n  TProps,\n  BlockByHashQuery,\n  BlockByHashQueryVariables,\n  BlockByHashProps<TChildProps>>) {\n    return ApolloReactHoc.withQuery<TProps, BlockByHashQuery, BlockByHashQueryVariables, BlockByHashProps<TChildProps>>(BlockByHashDocument, {\n      alias: 'withBlockByHash',\n      ...operationOptions\n    });\n};\nexport type BlockByHashQueryResult = ApolloReactCommon.QueryResult<BlockByHashQuery, BlockByHashQueryVariables>;\nexport const TransactionByIdDocument = gql`\n    query TransactionById($id: ID) {\n  transaction(id: $id) {\n    ...TransactionCommon\n  }\n}\n    ${TransactionCommonFragmentDoc}`;\nexport type TransactionByIdComponentProps = Omit<ApolloReactComponents.QueryComponentOptions<TransactionByIdQuery, TransactionByIdQueryVariables>, 'query'>;\n\n    export const TransactionByIdComponent = (props: TransactionByIdComponentProps) => (\n      <ApolloReactComponents.Query<TransactionByIdQuery, TransactionByIdQueryVariables> query={TransactionByIdDocument} {...props} />\n    );\n    \nexport type TransactionByIdProps<TChildProps = {}> = ApolloReactHoc.DataProps<TransactionByIdQuery, TransactionByIdQueryVariables> & TChildProps;\nexport function withTransactionById<TProps, TChildProps = {}>(operationOptions?: ApolloReactHoc.OperationOption<\n  TProps,\n  TransactionByIdQuery,\n  TransactionByIdQueryVariables,\n  TransactionByIdProps<TChildProps>>) {\n    return ApolloReactHoc.withQuery<TProps, TransactionByIdQuery, TransactionByIdQueryVariables, TransactionByIdProps<TChildProps>>(TransactionByIdDocument, {\n      alias: 'withTransactionById',\n      ...operationOptions\n    });\n};\nexport type TransactionByIdQueryResult = ApolloReactCommon.QueryResult<TransactionByIdQuery, TransactionByIdQueryVariables>;"],"sourceRoot":""}